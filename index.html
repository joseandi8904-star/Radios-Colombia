
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Radio Colombia Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="description" content="Escucha las mejores radios colombianas en vivo">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1DB954">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="RadioCO">
<link rel="apple-touch-icon" href="icons/icon-192.png">

<style>
* {
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}

body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
  background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 100%);
  color: white;
  min-height: 100vh;
  padding-bottom: 80px;
  overflow-x: hidden;
}

header {
  padding: 20px;
  font-size: 24px;
  font-weight: 700;
  background: rgba(29, 185, 84, 0.1);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(29, 185, 84, 0.2);
  position: sticky;
  top: 0;
  z-index: 100;
  display: flex;
  align-items: center;
  gap: 10px;
}

.player-section {
  padding: 20px;
  text-align: center;
}

#cover {
  width: 260px;
  height: 260px;
  border-radius: 20px;
  margin: 0 auto 20px;
  display: block;
  box-shadow: 0 20px 40px rgba(0,0,0,0.5);
  transition: transform 0.3s ease;
  object-fit: cover;
}

#cover.playing {
  animation: pulse 2s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.02); }
}

.now-playing {
  font-size: 18px;
  font-weight: 600;
  margin: 15px 0 5px;
  min-height: 25px;
}

.station-info {
  font-size: 14px;
  opacity: 0.7;
  margin-bottom: 20px;
}

.controls {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 20px;
  margin: 20px 0;
}

.control-btn {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  border: none;
  background: linear-gradient(135deg, #1DB954 0%, #1ed760 100%);
  color: white;
  font-size: 24px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(29, 185, 84, 0.4);
}

.control-btn:active {
  transform: scale(0.95);
}

.control-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.volume-control {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  margin: 20px auto;
  max-width: 300px;
  padding: 0 20px;
}

.volume-slider {
  flex: 1;
  -webkit-appearance: none;
  appearance: none;
  height: 6px;
  border-radius: 3px;
  background: rgba(255,255,255,0.2);
  outline: none;
}

.volume-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #1DB954;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(29, 185, 84, 0.5);
}

.volume-slider::-moz-range-thumb {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: #1DB954;
  cursor: pointer;
  border: none;
  box-shadow: 0 2px 8px rgba(29, 185, 84, 0.5);
}

.list {
  padding: 15px;
}

.section-title {
  font-size: 16px;
  font-weight: 600;
  margin: 20px 15px 10px;
  opacity: 0.8;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.radio {
  display: flex;
  align-items: center;
  padding: 15px;
  border-radius: 15px;
  background: rgba(255, 255, 255, 0.05);
  margin-bottom: 12px;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 1px solid rgba(255, 255, 255, 0.1);
  position: relative;
  overflow: hidden;
}

.radio::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(29, 185, 84, 0.2), transparent);
  transition: left 0.5s ease;
}

.radio:hover::before {
  left: 100%;
}

.radio:active {
  transform: scale(0.98);
}

.radio.playing {
  background: linear-gradient(135deg, rgba(29, 185, 84, 0.2) 0%, rgba(29, 185, 84, 0.1) 100%);
  border-color: #1DB954;
}

.radio img {
  width: 60px;
  height: 60px;
  border-radius: 12px;
  margin-right: 15px;
  object-fit: cover;
  box-shadow: 0 4px 8px rgba(0,0,0,0.3);
}

.radio-info {
  flex: 1;
}

.radio-name {
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 4px;
}

.radio-description {
  font-size: 13px;
  opacity: 0.6;
}

.playing-indicator {
  width: 20px;
  height: 20px;
  margin-left: 10px;
  display: none;
}

.radio.playing .playing-indicator {
  display: block;
}

.loading {
  text-align: center;
  padding: 20px;
  opacity: 0.7;
}

.loading-spinner {
  width: 40px;
  height: 40px;
  border: 4px solid rgba(29, 185, 84, 0.2);
  border-top-color: #1DB954;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 10px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.error-message {
  background: rgba(255, 59, 48, 0.2);
  border: 1px solid rgba(255, 59, 48, 0.5);
  border-radius: 12px;
  padding: 15px;
  margin: 15px;
  text-align: center;
  display: none;
}

.error-message.show {
  display: block;
}

footer {
  text-align: center;
  padding: 20px;
  opacity: 0.5;
  font-size: 13px;
  margin-top: 30px;
}

.install-prompt {
  background: linear-gradient(135deg, #1DB954 0%, #1ed760 100%);
  color: white;
  padding: 15px 20px;
  margin: 15px;
  border-radius: 12px;
  display: none;
  align-items: center;
  justify-content: space-between;
  box-shadow: 0 4px 15px rgba(29, 185, 84, 0.3);
}

.install-prompt.show {
  display: flex;
}

.install-btn {
  background: white;
  color: #1DB954;
  border: none;
  padding: 8px 16px;
  border-radius: 20px;
  font-weight: 600;
  cursor: pointer;
  transition: transform 0.2s ease;
}

.install-btn:active {
  transform: scale(0.95);
}

@media (max-width: 600px) {
  #cover {
    width: 220px;
    height: 220px;
  }
  
  .controls {
    gap: 15px;
  }
  
  .control-btn {
    width: 50px;
    height: 50px;
    font-size: 20px;
  }
}
</style>
</head>

<body>

<div class="install-prompt" id="installPrompt">
  <span>üì≤ Instala la app para mejor experiencia</span>
  <button class="install-btn" id="installBtn">Instalar</button>
</div>

<header>
  üéß Radio Colombia Pro
</header>

<div class="player-section">
  <img id="cover" src="https://i.imgur.com/ZcLLrkY.jpg" alt="Cover">
  
  <div class="now-playing" id="nowPlaying">Selecciona una radio</div>
  <div class="station-info" id="stationInfo"></div>
  
  <div class="loading" id="loading" style="display:none;">
    <div class="loading-spinner"></div>
    <div>Cargando...</div>
  </div>
  
  <div class="controls">
    <button class="control-btn" id="playBtn" disabled>
      <span id="playIcon">‚ñ∂Ô∏è</span>
    </button>
  </div>
  
  <div class="volume-control">
    <span>üîà</span>
    <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="80">
    <span>üîä</span>
  </div>
</div>

<div class="error-message" id="errorMessage">
  ‚ö†Ô∏è Error al reproducir. Intenta de nuevo.
</div>

<div class="section-title">üéµ Emisoras Disponibles</div>

<div class="list" id="radioList">
  <div class="radio" data-url="https://streaming.rcnradio.com/rcnradio" data-img="https://upload.wikimedia.org/wikipedia/commons/4/4e/RCN_Radio_logo.png" data-name="RCN Radio" data-desc="Noticias y m√∫sica">
    <img src="https://upload.wikimedia.org/wikipedia/commons/4/4e/RCN_Radio_logo.png" alt="RCN Radio">
    <div class="radio-info">
      <div class="radio-name">RCN Radio</div>
      <div class="radio-description">Noticias y m√∫sica</div>
    </div>
    <div class="playing-indicator">üéµ</div>
  </div>

  <div class="radio" data-url="https://playerservices.streamtheworld.com/api/livestream-redirect/CARACOL_RADIO.mp3" data-img="https://upload.wikimedia.org/wikipedia/commons/6/6b/Caracol_Radio_logo.png" data-name="Caracol Radio" data-desc="Informaci√≥n y entretenimiento">
    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/Caracol_Radio_logo.png" alt="Caracol Radio">
    <div class="radio-info">
      <div class="radio-name">Caracol Radio</div>
      <div class="radio-description">Informaci√≥n y entretenimiento</div>
    </div>
    <div class="playing-indicator">üéµ</div>
  </div>

  <div class="radio" data-url="https://streaming.lamega.com.co/lamega.mp3" data-img="https://upload.wikimedia.org/wikipedia/commons/1/19/La_Mega_Colombia_logo.png" data-name="La Mega" data-desc="La mejor m√∫sica">
    <img src="https://upload.wikimedia.org/wikipedia/commons/1/19/La_Mega_Colombia_logo.png" alt="La Mega">
    <div class="radio-info">
      <div class="radio-name">La Mega</div>
      <div class="radio-description">La mejor m√∫sica</div>
    </div>
    <div class="playing-indicator">üéµ</div>
  </div>

  <div class="radio" data-url="https://streaming.radionacional.co/rtvc.mp3" data-img="https://upload.wikimedia.org/wikipedia/commons/5/55/Radio_Nacional_de_Colombia_logo.png" data-name="Radio Nacional" data-desc="Radio p√∫blica colombiana">
    <img src="https://upload.wikimedia.org/wikipedia/commons/5/55/Radio_Nacional_de_Colombia_logo.png" alt="Radio Nacional">
    <div class="radio-info">
      <div class="radio-name">Radio Nacional</div>
      <div class="radio-description">Radio p√∫blica colombiana</div>
    </div>
    <div class="playing-indicator">üéµ</div>
  </div>
</div>

<footer>
  üìª Las mejores radios colombianas en vivo
  <br>
  <small>v2.0 ‚Ä¢ PWA Edition</small>
</footer>

<audio id="player" preload="none"></audio>

<script>
// Variables globales
const player = document.getElementById("player");
const cover = document.getElementById("cover");
const playBtn = document.getElementById("playBtn");
const playIcon = document.getElementById("playIcon");
const nowPlaying = document.getElementById("nowPlaying");
const stationInfo = document.getElementById("stationInfo");
const loading = document.getElementById("loading");
const errorMessage = document.getElementById("errorMessage");
const volumeSlider = document.getElementById("volumeSlider");
const radioItems = document.querySelectorAll(".radio");

let currentStation = null;
let isPlaying = false;

// Configuraci√≥n inicial
player.volume = 0.8;

// Media Session API para controles en notificaciones
function updateMediaSession(station) {
  if ('mediaSession' in navigator) {
    navigator.mediaSession.metadata = new MediaMetadata({
      title: station.name,
      artist: station.description || 'Radio en vivo',
      album: 'Radio Colombia Pro',
      artwork: [
        { src: station.img, sizes: '512x512', type: 'image/png' }
      ]
    });

    navigator.mediaSession.setActionHandler('play', () => {
      player.play();
    });

    navigator.mediaSession.setActionHandler('pause', () => {
      player.pause();
    });
  }
}

// Funci√≥n para reproducir
function playStation(url, img, name, desc) {
  // Limpiar errores
  errorMessage.classList.remove('show');
  
  // Guardar estaci√≥n actual
  currentStation = { url, img, name, description: desc };
  
  // Actualizar UI
  loading.style.display = 'block';
  cover.src = img;
  nowPlaying.textContent = name;
  stationInfo.textContent = desc;
  
  // Actualizar clases de radio items
  radioItems.forEach(item => item.classList.remove('playing'));
  event.currentTarget.classList.add('playing');
  
  // Configurar y reproducir
  player.src = url;
  player.load();
  
  const playPromise = player.play();
  
  if (playPromise !== undefined) {
    playPromise
      .then(() => {
        loading.style.display = 'none';
        playBtn.disabled = false;
        updateMediaSession(currentStation);
        cover.classList.add('playing');
        
        // Mostrar anuncio si est√° disponible
        if (window.AndroidAd) {
          AndroidAd.showInterstitial();
        }
      })
      .catch(error => {
        console.error('Error al reproducir:', error);
        loading.style.display = 'none';
        errorMessage.classList.add('show');
        setTimeout(() => errorMessage.classList.remove('show'), 3000);
      });
  }
}

// Event listeners para radios
radioItems.forEach(item => {
  item.addEventListener('click', function(e) {
    const url = this.dataset.url;
    const img = this.dataset.img;
    const name = this.dataset.name;
    const desc = this.dataset.desc;
    playStation.call(this, url, img, name, desc);
  });
});

// Control de reproducci√≥n/pausa
playBtn.addEventListener('click', () => {
  if (player.paused) {
    player.play();
  } else {
    player.pause();
  }
});

// Actualizar bot√≥n de play/pause
player.addEventListener('play', () => {
  isPlaying = true;
  playIcon.textContent = '‚è∏Ô∏è';
  cover.classList.add('playing');
});

player.addEventListener('pause', () => {
  isPlaying = false;
  playIcon.textContent = '‚ñ∂Ô∏è';
  cover.classList.remove('playing');
});

// Control de volumen
volumeSlider.addEventListener('input', (e) => {
  player.volume = e.target.value / 100;
  
  // Guardar preferencia
  localStorage.setItem('volume', e.target.value);
});

// Cargar volumen guardado
const savedVolume = localStorage.getItem('volume');
if (savedVolume) {
  volumeSlider.value = savedVolume;
  player.volume = savedVolume / 100;
}

// Manejo de errores
player.addEventListener('error', (e) => {
  loading.style.display = 'none';
  errorMessage.classList.add('show');
  setTimeout(() => errorMessage.classList.remove('show'), 3000);
  console.error('Error en el player:', e);
});

// PWA Service Worker
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js")
    .then(reg => console.log('Service Worker registrado', reg))
    .catch(err => console.log('Error al registrar SW', err));
}

// Instalaci√≥n de PWA
let deferredPrompt;

window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  document.getElementById('installPrompt').classList.add('show');
});

document.getElementById('installBtn').addEventListener('click', async () => {
  if (deferredPrompt) {
    deferredPrompt.prompt();
    const { outcome } = await deferredPrompt.userChoice;
    console.log(`User response: ${outcome}`);
    deferredPrompt = null;
    document.getElementById('installPrompt').classList.remove('show');
  }
});

window.addEventListener('appinstalled', () => {
  console.log('PWA instalada');
  document.getElementById('installPrompt').classList.remove('show');
});

// Prevenir zoom en doble tap (mejor experiencia app)
let lastTouchEnd = 0;
document.addEventListener('touchend', (e) => {
  const now = Date.now();
  if (now - lastTouchEnd <= 300) {
    e.preventDefault();
  }
  lastTouchEnd = now;
}, false);
</script>

</body>
</html>
